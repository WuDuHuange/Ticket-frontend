import{d as ce,k as pe,l as fe,r as m,ad as _e,o as ve,au as A,c as V,e as i,p as G,f as a,t as o,w as l,g as s,$ as be,q as w,y as u,i as p,B as ge,G as E,Q as R,I as $e,av as we,as as ye,H as he,at as H,s as ke,E as v,ac as Ve,h as c}from"./index-DaxlKADp.js";import{f as Ce}from"./helpers-BtQK9j-g.js";import{_ as Te}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Me={class:"team-management-view"},De={class:"page-header"},Ue={class:"team-header"},Be={class:"team-icon"},Ne={class:"team-info"},Fe={class:"member-count"},Ie={class:"team-description"},Ae={class:"team-members"},Ee={class:"team-footer"},Re={class:"created-date"},ze={class:"members-dialog"},Se={class:"add-member-section"},qe={class:"members-list"},Je=ce({__name:"TeamManagementView",setup(Le){const{t:r}=pe(),Q=fe(),C=m(!1),T=m(!1),z=m([]),b=m(!1),y=m(!1),M=m(),d=_e({id:"",name:"",description:""}),k=m(!1),D=m(!1),U=m(null),h=m([]),B=m([]),g=m(""),W={name:[{required:!0,message:()=>r("admin.teamNameRequired"),trigger:"blur"}]};ve(async()=>{Q.setBreadcrumbs([{label:r("nav.administration")},{label:r("nav.teamManagement")}]),await N()});async function N(){C.value=!0;try{const e=await A.getTeams();e.code===200&&e.data&&(z.value=e.data)}catch(e){console.error("Failed to load teams:",e)}finally{C.value=!1}}function K(e){return e.split(" ").map(n=>n[0]).join("").toUpperCase().slice(0,2)}function O(){y.value=!1,d.id="",d.name="",d.description="",b.value=!0}function P(e){y.value=!0,d.id=e.id,d.name=e.name,d.description=e.description||"",b.value=!0}async function X(e){U.value=e,k.value=!0,D.value=!0;try{h.value=e.members||[],B.value=[{id:"1",name:"John Doe"},{id:"2",name:"Jane Smith"},{id:"3",name:"Bob Wilson"},{id:"4",name:"Alice Brown"}]}catch(n){console.error("Failed to load members:",n),v.error(r("messages.loadFailed"))}finally{D.value=!1}}function Y(){if(!g.value||!U.value)return;const e=B.value.find(n=>n.id===g.value);e&&(h.value.push({id:e.id,userName:e.name,role:"Member"}),g.value="",v.success(r("admin.memberAdded")))}function Z(e){h.value=h.value.filter(n=>n.id!==e.id),v.success(r("admin.memberRemoved"))}async function x(e){try{await Ve.confirm(`${r("admin.confirmDeleteTeam")} "${e.name}"?`,r("admin.deleteTeam"),{type:"warning"}),v.success(r("admin.teamDeleted"))}catch{}}async function ee(){M.value&&await M.value.validate(async e=>{if(e){T.value=!0;try{y.value?(await A.updateTeam(d.id,{name:d.name,description:d.description})).code===200&&(v.success(r("admin.teamUpdated")),await N()):(await A.createTeam({name:d.name,description:d.description})).code===200&&(v.success(r("admin.teamCreated")),await N()),b.value=!1}catch(n){console.error("Failed to save team:",n),v.error("Failed to save team")}finally{T.value=!1}}})}return(e,n)=>{const f=s("el-icon"),_=s("el-button"),F=s("el-dropdown-item"),ae=s("el-dropdown-menu"),le=s("el-dropdown"),S=s("el-avatar"),te=s("el-card"),ne=s("el-col"),oe=s("el-row"),q=s("el-input"),J=s("el-form-item"),se=s("el-form"),L=s("el-dialog"),de=s("el-option"),ie=s("el-select"),me=s("el-divider"),I=s("el-table-column"),re=s("el-tag"),ue=s("el-table"),j=be("loading");return c(),V("div",Me,[i("div",De,[i("h1",null,o(e.$t("nav.teamManagement")),1),a(_,{type:"primary",onClick:O},{default:l(()=>[a(f,null,{default:l(()=>[a(p(ge))]),_:1}),u(" "+o(e.$t("admin.addTeam")),1)]),_:1})]),G((c(),w(oe,{gutter:20},{default:l(()=>[(c(!0),V(E,null,R(z.value,t=>(c(),w(ne,{xs:24,sm:12,lg:8,key:t.id},{default:l(()=>[a(te,{class:"team-card"},{default:l(()=>[i("div",Ue,[i("div",Be,[a(f,{size:32},{default:l(()=>[a(p($e))]),_:1})]),i("div",Ne,[i("h3",null,o(t.name),1),i("span",Fe,o(t.memberCount)+" "+o(e.$t("admin.teamMembers")),1)]),a(le,{trigger:"click"},{dropdown:l(()=>[a(ae,null,{default:l(()=>[a(F,{onClick:$=>P(t)},{default:l(()=>[a(f,null,{default:l(()=>[a(p(ye))]),_:1}),u(" "+o(e.$t("common.edit")),1)]),_:1},8,["onClick"]),a(F,{onClick:$=>X(t)},{default:l(()=>[a(f,null,{default:l(()=>[a(p(he))]),_:1}),u(" "+o(e.$t("admin.manageMembers")),1)]),_:1},8,["onClick"]),a(F,{divided:"",onClick:$=>x(t)},{default:l(()=>[a(f,null,{default:l(()=>[a(p(H))]),_:1}),u(" "+o(e.$t("common.delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),default:l(()=>[a(_,{text:""},{default:l(()=>[a(f,null,{default:l(()=>[a(p(we))]),_:1})]),_:1})]),_:2},1024)]),i("p",Ie,o(t.description||e.$t("admin.noDescription")),1),i("div",Ae,[(c(!0),V(E,null,R(t.members?.slice(0,5),$=>(c(),w(S,{key:$.id,size:32,class:"member-avatar"},{default:l(()=>[u(o(K($.userName)),1)]),_:2},1024))),128)),t.memberCount>5?(c(),w(S,{key:0,size:32,class:"member-avatar more"},{default:l(()=>[u(" +"+o(t.memberCount-5),1)]),_:2},1024)):ke("",!0)]),i("div",Ee,[i("span",Re,o(e.$t("admin.createdDate"))+" "+o(p(Ce)(t.createdAt)),1)])]),_:2},1024)]),_:2},1024))),128))]),_:1})),[[j,C.value]]),a(L,{modelValue:b.value,"onUpdate:modelValue":n[3]||(n[3]=t=>b.value=t),title:y.value?e.$t("admin.editTeam"):e.$t("admin.addTeam"),width:"500px"},{footer:l(()=>[a(_,{onClick:n[2]||(n[2]=t=>b.value=!1)},{default:l(()=>[u(o(e.$t("common.cancel")),1)]),_:1}),a(_,{type:"primary",onClick:ee,loading:T.value},{default:l(()=>[u(o(y.value?e.$t("admin.updateTeam"):e.$t("admin.createTeam")),1)]),_:1},8,["loading"])]),default:l(()=>[a(se,{model:d,rules:W,ref_key:"formRef",ref:M,"label-width":"100px"},{default:l(()=>[a(J,{label:e.$t("common.name"),prop:"name"},{default:l(()=>[a(q,{modelValue:d.name,"onUpdate:modelValue":n[0]||(n[0]=t=>d.name=t),placeholder:e.$t("admin.enterTeamName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(J,{label:e.$t("common.description"),prop:"description"},{default:l(()=>[a(q,{modelValue:d.description,"onUpdate:modelValue":n[1]||(n[1]=t=>d.description=t),type:"textarea",rows:3,placeholder:e.$t("admin.enterTeamDescription")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),a(L,{modelValue:k.value,"onUpdate:modelValue":n[6]||(n[6]=t=>k.value=t),title:e.$t("admin.manageMembers")+" - "+U.value?.name,width:"600px"},{footer:l(()=>[a(_,{onClick:n[5]||(n[5]=t=>k.value=!1)},{default:l(()=>[u(o(e.$t("common.close")),1)]),_:1})]),default:l(()=>[i("div",ze,[i("div",Se,[a(ie,{modelValue:g.value,"onUpdate:modelValue":n[4]||(n[4]=t=>g.value=t),placeholder:e.$t("admin.selectUser"),filterable:"",style:{width:"300px"}},{default:l(()=>[(c(!0),V(E,null,R(B.value,t=>(c(),w(de,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"]),a(_,{type:"primary",onClick:Y,disabled:!g.value},{default:l(()=>[u(o(e.$t("admin.addMember")),1)]),_:1},8,["disabled"])]),a(me),i("div",qe,[i("h4",null,o(e.$t("admin.currentMembers")),1),G((c(),w(ue,{data:h.value},{default:l(()=>[a(I,{prop:"userName",label:e.$t("common.name")},null,8,["label"]),a(I,{prop:"role",label:e.$t("admin.memberRole"),width:"150"},{default:l(({row:t})=>[a(re,{size:"small"},{default:l(()=>[u(o(t.role||"Member"),1)]),_:2},1024)]),_:1},8,["label"]),a(I,{label:e.$t("common.actions"),width:"100"},{default:l(({row:t})=>[a(_,{text:"",type:"danger",onClick:$=>Z(t)},{default:l(()=>[a(f,null,{default:l(()=>[a(p(H))]),_:1})]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[j,D.value]])])])]),_:1},8,["modelValue","title"])])}}}),Qe=Te(Je,[["__scopeId","data-v-766c50e8"]]);export{Qe as default};
