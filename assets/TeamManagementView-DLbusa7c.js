import{d as W,p as Y,q as Z,r as f,a0 as x,X as ee,ai as U,c as C,a as i,v as ae,b as a,t as o,w as t,e as s,_ as te,y as w,o as c,i as r,h as u,D as ne,F as E,l as I,I as oe,al as le,aj as se,n as de,ak as ie,z as me,E as $,a4 as re}from"./index-Myl3Wffr.js";import{b as ce}from"./helpers-BtW4N_bD.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";const _e={class:"team-management-view"},pe={class:"page-header"},fe={class:"team-header"},ve={class:"team-icon"},ge={class:"team-info"},be={class:"member-count"},we={class:"team-description"},$e={class:"team-members"},ye={class:"team-footer"},ke={class:"created-date"},Te=W({__name:"TeamManagementView",setup(he){const{t:m}=Y(),z=Z(),y=f(!1),k=f(!1),V=f([]),_=f(!1),v=f(!1),T=f(),l=x({id:"",name:"",description:""}),q={name:[{required:!0,message:()=>m("admin.teamNameRequired"),trigger:"blur"}]};ee(async()=>{z.setBreadcrumbs([{label:m("nav.administration")},{label:m("nav.teamManagement")}]),await M()});async function M(){y.value=!0;try{const e=await U.getTeams();e.code===200&&e.data&&(V.value=e.data)}finally{y.value=!1}}function F(e){return e.split(" ").map(d=>d[0]).join("").toUpperCase().slice(0,2)}function R(){v.value=!1,l.id="",l.name="",l.description="",_.value=!0}function S(e){v.value=!0,l.id=e.id,l.name=e.name,l.description=e.description||"",_.value=!0}function j(e){$.info(`${m("admin.manageMembers")}: ${e.name}`)}async function A(e){try{await re.confirm(`${m("admin.confirmDeleteTeam")} "${e.name}"?`,m("admin.deleteTeam"),{type:"warning"}),$.success(m("admin.teamDeleted"))}catch{}}async function H(){T.value&&await T.value.validate(async e=>{if(e){k.value=!0;try{v.value?$.success(m("admin.teamUpdated")):(await U.createTeam({name:l.name,description:l.description})).code===200&&($.success(m("admin.teamCreated")),await M()),_.value=!1}finally{k.value=!1}}})}return(e,d)=>{const p=s("el-icon"),b=s("el-button"),h=s("el-dropdown-item"),L=s("el-dropdown-menu"),X=s("el-dropdown"),D=s("el-avatar"),G=s("el-card"),J=s("el-col"),K=s("el-row"),N=s("el-input"),B=s("el-form-item"),O=s("el-form"),P=s("el-dialog"),Q=te("loading");return c(),C("div",_e,[i("div",pe,[i("h1",null,o(e.$t("nav.teamManagement")),1),a(b,{type:"primary",onClick:R},{default:t(()=>[a(p,null,{default:t(()=>[a(u(ne))]),_:1}),r(" "+o(e.$t("admin.addTeam")),1)]),_:1})]),ae((c(),w(K,{gutter:20},{default:t(()=>[(c(!0),C(E,null,I(V.value,n=>(c(),w(J,{xs:24,sm:12,lg:8,key:n.id},{default:t(()=>[a(G,{class:"team-card"},{default:t(()=>[i("div",fe,[i("div",ve,[a(p,{size:32},{default:t(()=>[a(u(oe))]),_:1})]),i("div",ge,[i("h3",null,o(n.name),1),i("span",be,o(n.memberCount)+" "+o(e.$t("admin.teamMembers")),1)]),a(X,{trigger:"click"},{dropdown:t(()=>[a(L,null,{default:t(()=>[a(h,{onClick:g=>S(n)},{default:t(()=>[a(p,null,{default:t(()=>[a(u(se))]),_:1}),r(" "+o(e.$t("common.edit")),1)]),_:1},8,["onClick"]),a(h,{onClick:g=>j(n)},{default:t(()=>[a(p,null,{default:t(()=>[a(u(de))]),_:1}),r(" "+o(e.$t("admin.manageMembers")),1)]),_:1},8,["onClick"]),a(h,{divided:"",onClick:g=>A(n)},{default:t(()=>[a(p,null,{default:t(()=>[a(u(ie))]),_:1}),r(" "+o(e.$t("common.delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),default:t(()=>[a(b,{text:""},{default:t(()=>[a(p,null,{default:t(()=>[a(u(le))]),_:1})]),_:1})]),_:2},1024)]),i("p",we,o(n.description||e.$t("admin.noDescription")),1),i("div",$e,[(c(!0),C(E,null,I(n.members?.slice(0,5),g=>(c(),w(D,{key:g.id,size:32,class:"member-avatar"},{default:t(()=>[r(o(F(g.userName)),1)]),_:2},1024))),128)),n.memberCount>5?(c(),w(D,{key:0,size:32,class:"member-avatar more"},{default:t(()=>[r(" +"+o(n.memberCount-5),1)]),_:2},1024)):me("",!0)]),i("div",ye,[i("span",ke,o(e.$t("admin.createdDate"))+" "+o(u(ce)(n.createdAt)),1)])]),_:2},1024)]),_:2},1024))),128))]),_:1})),[[Q,y.value]]),a(P,{modelValue:_.value,"onUpdate:modelValue":d[3]||(d[3]=n=>_.value=n),title:v.value?e.$t("admin.editTeam"):e.$t("admin.addTeam"),width:"500px"},{footer:t(()=>[a(b,{onClick:d[2]||(d[2]=n=>_.value=!1)},{default:t(()=>[r(o(e.$t("common.cancel")),1)]),_:1}),a(b,{type:"primary",onClick:H,loading:k.value},{default:t(()=>[r(o(v.value?e.$t("admin.updateTeam"):e.$t("admin.createTeam")),1)]),_:1},8,["loading"])]),default:t(()=>[a(O,{model:l,rules:q,ref_key:"formRef",ref:T,"label-width":"100px"},{default:t(()=>[a(B,{label:e.$t("common.name"),prop:"name"},{default:t(()=>[a(N,{modelValue:l.name,"onUpdate:modelValue":d[0]||(d[0]=n=>l.name=n),placeholder:e.$t("admin.enterTeamName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(B,{label:e.$t("common.description"),prop:"description"},{default:t(()=>[a(N,{modelValue:l.description,"onUpdate:modelValue":d[1]||(d[1]=n=>l.description=n),type:"textarea",rows:3,placeholder:e.$t("admin.enterTeamDescription")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),De=ue(Te,[["__scopeId","data-v-bf6dbbbb"]]);export{De as default};
