import{d as ee,k as le,l as ae,r as $,ad as C,al as te,o as oe,aP as D,E as f,c as ne,e as g,f as e,t as s,w as a,g as u,y as b,p as ie,$ as se,q as ue,i as de,as as me,ap as re,h as M}from"./index-C6r5wVjW.js";import{_ as pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const fe={class:"system-settings-view"},ge={class:"page-header"},be={class:"form-unit"},ce={class:"form-unit"},ve=ee({__name:"SystemSettingsView",setup(ye){const{t:w}=le(),B=ae(),L=$(!1),F=$("general"),U=$([]),S=$(!1),k=$(!1),N=$(),i=C({id:"",priority:"medium",responseTime:8,resolutionTime:24,description:"",isActive:!0}),q={priority:[{required:!0,message:"Please select priority",trigger:"change"}],responseTime:[{required:!0,message:"Please enter response time",trigger:"blur"}],resolutionTime:[{required:!0,message:"Please enter resolution time",trigger:"blur"}]},c=C({systemName:"IT Service Desk",supportEmail:"support@university.edu",language:te(),timezone:"America/New_York"}),m=C({smtpServer:"smtp.university.edu",smtpPort:587,useTLS:!0,username:"",password:"",fromAddress:"noreply@university.edu"}),d=C({newTicket:!0,ticketAssignment:!0,statusChange:!0,newComment:!0,slaWarning:!0,maintenance:!0,security:!0});oe(async()=>{B.setBreadcrumbs([{label:w("nav.administration")},{label:w("nav.systemSettings")}]),await P()});async function P(){L.value=!0;try{const l=await D.getSLAConfigs();console.log("Load SLA configs response:",l),l.code===200&&l.data?(U.value=l.data,console.log("Loaded SLA configs:",U.value)):(console.error("Failed to load SLA configs:",l),f.error("Failed to load SLA configurations"))}catch(l){console.error("Failed to load SLA configs:",l),f.error("Failed to load SLA configurations")}finally{L.value=!1}}function I(l){return{low:"info",medium:"",high:"warning",urgent:"danger"}[l]||""}function W(l){re(l),f.success(w("messages.languageChanged"))}function R(){f.success(w("messages.saveSuccess"))}function Y(l){i.id=l.id,i.priority=l.priority,i.responseTime=l.responseTime,i.resolutionTime=l.resolutionTime,i.description=l.description||"",i.isActive=l.isActive!==!1,S.value=!0}async function G(){N.value&&await N.value.validate(async l=>{if(l){k.value=!0;try{const o={priority:i.priority,responseTime:i.responseTime,resolutionTime:i.resolutionTime,description:i.description,isActive:i.isActive};console.log("Updating SLA data:",o,"id:",i.id);const r=await D.updateSLAConfig(i.id,o);if(console.log("Update SLA response:",r),r.code===200)f.success(w("messages.saveSuccess")),S.value=!1,await P();else throw new Error(r.message||"Failed to update SLA")}catch(o){console.error("Failed to save SLA:",o),f.error(o.message||"Failed to save SLA")}finally{k.value=!1}}})}function H(){f.info("Testing email connection..."),setTimeout(()=>{f.success("Email connection successful!")},1500)}function j(){f.success("Email settings saved successfully")}function J(){f.success("Notification settings saved successfully")}return(l,o)=>{const r=u("el-input"),n=u("el-form-item"),p=u("el-option"),E=u("el-select"),y=u("el-button"),T=u("el-form"),A=u("el-card"),_=u("el-tab-pane"),z=u("el-tag"),V=u("el-table-column"),K=u("el-icon"),O=u("el-table"),h=u("el-input-number"),v=u("el-switch"),Q=u("el-divider"),X=u("el-tabs"),Z=u("el-dialog"),x=se("loading");return M(),ne("div",fe,[g("div",ge,[g("h1",null,s(l.$t("admin.systemSettings")),1)]),e(X,{modelValue:F.value,"onUpdate:modelValue":o[17]||(o[17]=t=>F.value=t),class:"settings-tabs"},{default:a(()=>[e(_,{label:l.$t("admin.generalSettings"),name:"general"},{default:a(()=>[e(A,null,{header:a(()=>[g("span",null,s(l.$t("admin.generalSettings")),1)]),default:a(()=>[e(T,{model:c,"label-width":"200px"},{default:a(()=>[e(n,{label:l.$t("admin.systemName")},{default:a(()=>[e(r,{modelValue:c.systemName,"onUpdate:modelValue":o[0]||(o[0]=t=>c.systemName=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.supportEmail")},{default:a(()=>[e(r,{modelValue:c.supportEmail,"onUpdate:modelValue":o[1]||(o[1]=t=>c.supportEmail=t),type:"email"},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.defaultLanguage")},{default:a(()=>[e(E,{modelValue:c.language,"onUpdate:modelValue":o[2]||(o[2]=t=>c.language=t),style:{width:"200px"},onChange:W},{default:a(()=>[e(p,{label:"English",value:"en"}),e(p,{label:"中文",value:"zh"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.timezone")},{default:a(()=>[e(E,{modelValue:c.timezone,"onUpdate:modelValue":o[3]||(o[3]=t=>c.timezone=t),style:{width:"300px"}},{default:a(()=>[e(p,{label:"UTC",value:"UTC"}),e(p,{label:"America/New_York (EST)",value:"America/New_York"}),e(p,{label:"America/Los_Angeles (PST)",value:"America/Los_Angeles"}),e(p,{label:"Europe/London (GMT)",value:"Europe/London"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(n,null,{default:a(()=>[e(y,{type:"primary",onClick:R},{default:a(()=>[b(s(l.$t("admin.saveChanges")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["label"]),e(_,{label:l.$t("admin.slaConfiguration"),name:"sla"},{default:a(()=>[e(A,null,{header:a(()=>[g("span",null,s(l.$t("admin.slaConfiguration")),1)]),default:a(()=>[ie((M(),ue(O,{data:U.value},{default:a(()=>[e(V,{prop:"priority",label:l.$t("common.priority"),width:"120"},{default:a(({row:t})=>[e(z,{type:I(t.priority),size:"small"},{default:a(()=>[b(s(t.priority),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(V,{prop:"responseTime",label:l.$t("admin.responseTime"),width:"150"},{default:a(({row:t})=>[b(s(t.responseTime)+" "+s(l.$t("common.hours")),1)]),_:1},8,["label"]),e(V,{prop:"resolutionTime",label:l.$t("admin.resolutionTime"),width:"150"},{default:a(({row:t})=>[b(s(t.resolutionTime)+" "+s(l.$t("common.hours")),1)]),_:1},8,["label"]),e(V,{prop:"description",label:l.$t("common.description"),"min-width":"200"},null,8,["label"]),e(V,{prop:"isActive",label:l.$t("common.status"),width:"100"},{default:a(({row:t})=>[e(z,{type:t.isActive?"success":"info",size:"small"},{default:a(()=>[b(s(t.isActive?l.$t("common.active"):l.$t("common.inactive")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(V,{label:l.$t("common.actions"),width:"120"},{default:a(({row:t})=>[e(y,{text:"",type:"primary",onClick:Ve=>Y(t)},{default:a(()=>[e(K,null,{default:a(()=>[e(de(me))]),_:1})]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[x,L.value]])]),_:1})]),_:1},8,["label"]),e(_,{label:l.$t("admin.emailConfiguration"),name:"email"},{default:a(()=>[e(A,null,{header:a(()=>[g("span",null,s(l.$t("admin.emailConfiguration")),1)]),default:a(()=>[e(T,{model:m,"label-width":"200px"},{default:a(()=>[e(n,{label:l.$t("admin.smtpServer")},{default:a(()=>[e(r,{modelValue:m.smtpServer,"onUpdate:modelValue":o[4]||(o[4]=t=>m.smtpServer=t),placeholder:"smtp.example.com"},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.smtpPort")},{default:a(()=>[e(h,{modelValue:m.smtpPort,"onUpdate:modelValue":o[5]||(o[5]=t=>m.smtpPort=t),min:1,max:65535},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.useTLS")},{default:a(()=>[e(v,{modelValue:m.useTLS,"onUpdate:modelValue":o[6]||(o[6]=t=>m.useTLS=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.username")},{default:a(()=>[e(r,{modelValue:m.username,"onUpdate:modelValue":o[7]||(o[7]=t=>m.username=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.password")},{default:a(()=>[e(r,{modelValue:m.password,"onUpdate:modelValue":o[8]||(o[8]=t=>m.password=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.senderEmail")},{default:a(()=>[e(r,{modelValue:m.fromAddress,"onUpdate:modelValue":o[9]||(o[9]=t=>m.fromAddress=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,null,{default:a(()=>[e(y,{onClick:H},{default:a(()=>[b(s(l.$t("admin.testConnection")),1)]),_:1}),e(y,{type:"primary",onClick:j},{default:a(()=>[b(s(l.$t("admin.saveChanges")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["label"]),e(_,{label:l.$t("admin.notificationSettings"),name:"notifications"},{default:a(()=>[e(A,null,{header:a(()=>[g("span",null,s(l.$t("admin.notificationSettings")),1)]),default:a(()=>[e(T,{model:d,"label-width":"250px"},{default:a(()=>[g("h4",null,s(l.$t("admin.ticketNotifications")),1),e(n,{label:l.$t("admin.newTicketNotify")},{default:a(()=>[e(v,{modelValue:d.newTicket,"onUpdate:modelValue":o[10]||(o[10]=t=>d.newTicket=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.ticketAssignmentNotify")},{default:a(()=>[e(v,{modelValue:d.ticketAssignment,"onUpdate:modelValue":o[11]||(o[11]=t=>d.ticketAssignment=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.ticketUpdateNotify")},{default:a(()=>[e(v,{modelValue:d.statusChange,"onUpdate:modelValue":o[12]||(o[12]=t=>d.statusChange=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.newCommentNotify")},{default:a(()=>[e(v,{modelValue:d.newComment,"onUpdate:modelValue":o[13]||(o[13]=t=>d.newComment=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.slaWarningNotify")},{default:a(()=>[e(v,{modelValue:d.slaWarning,"onUpdate:modelValue":o[14]||(o[14]=t=>d.slaWarning=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(Q),g("h4",null,s(l.$t("admin.systemNotifications")),1),e(n,{label:l.$t("admin.maintenanceNotify")},{default:a(()=>[e(v,{modelValue:d.maintenance,"onUpdate:modelValue":o[15]||(o[15]=t=>d.maintenance=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.securityNotify")},{default:a(()=>[e(v,{modelValue:d.security,"onUpdate:modelValue":o[16]||(o[16]=t=>d.security=t)},null,8,["modelValue"])]),_:1},8,["label"]),e(n,null,{default:a(()=>[e(y,{type:"primary",onClick:J},{default:a(()=>[b(s(l.$t("admin.saveChanges")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["label"])]),_:1},8,["modelValue"]),e(Z,{modelValue:S.value,"onUpdate:modelValue":o[24]||(o[24]=t=>S.value=t),title:l.$t("admin.editSLA"),width:"500px"},{footer:a(()=>[e(y,{onClick:o[23]||(o[23]=t=>S.value=!1)},{default:a(()=>[b(s(l.$t("common.cancel")),1)]),_:1}),e(y,{type:"primary",onClick:G,loading:k.value},{default:a(()=>[b(s(l.$t("common.save")),1)]),_:1},8,["loading"])]),default:a(()=>[e(T,{model:i,rules:q,ref_key:"slaFormRef",ref:N,"label-width":"160px"},{default:a(()=>[e(n,{label:l.$t("common.priority"),prop:"priority"},{default:a(()=>[e(E,{modelValue:i.priority,"onUpdate:modelValue":o[18]||(o[18]=t=>i.priority=t),style:{width:"100%"},disabled:""},{default:a(()=>[e(p,{label:"Low",value:"low"}),e(p,{label:"Medium",value:"medium"}),e(p,{label:"High",value:"high"}),e(p,{label:"Urgent",value:"urgent"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("admin.responseTime"),prop:"responseTime"},{default:a(()=>[e(h,{modelValue:i.responseTime,"onUpdate:modelValue":o[19]||(o[19]=t=>i.responseTime=t),min:1,max:720,style:{width:"100%"}},null,8,["modelValue"]),g("span",be,s(l.$t("common.hours")),1)]),_:1},8,["label"]),e(n,{label:l.$t("admin.resolutionTime"),prop:"resolutionTime"},{default:a(()=>[e(h,{modelValue:i.resolutionTime,"onUpdate:modelValue":o[20]||(o[20]=t=>i.resolutionTime=t),min:1,max:720,style:{width:"100%"}},null,8,["modelValue"]),g("span",ce,s(l.$t("common.hours")),1)]),_:1},8,["label"]),e(n,{label:l.$t("common.description"),prop:"description"},{default:a(()=>[e(r,{modelValue:i.description,"onUpdate:modelValue":o[21]||(o[21]=t=>i.description=t),type:"textarea",rows:3},null,8,["modelValue"])]),_:1},8,["label"]),e(n,{label:l.$t("common.active"),prop:"isActive"},{default:a(()=>[e(v,{modelValue:i.isActive,"onUpdate:modelValue":o[22]||(o[22]=t=>i.isActive=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Se=pe(ve,[["__scopeId","data-v-55692c57"]]);export{Se as default};
