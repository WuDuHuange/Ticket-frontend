import{d as Z,p as x,q as ee,r as c,ab as D,X as ae,ap as E,c as le,a as m,b as e,t as s,w as l,e as n,o as I,i as d,h as y,D as te,P as oe,v as ne,Y as se,y as re,aq as de,I as ue,ar as ie,E as _,aa as pe}from"./index-CMTRBr-a.js";import{f as me}from"./helpers-BtQK9j-g.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";const fe={class:"user-management-view"},_e={class:"page-header"},ve={class:"user-info"},ge={class:"user-details"},be={class:"user-name"},ye={class:"user-email"},we={class:"pagination-wrapper"},$e=Z({__name:"UserManagementView",setup(Ue){const{t:k}=x(),F=ee(),C=c(!1),V=c([]),w=c(1),h=c(10),M=c(0),r=D({role:"",keyword:""}),v=c(!1),$=c(null),g=D({role:""});ae(async()=>{F.setBreadcrumbs([{label:k("nav.administration")},{label:k("nav.userManagement")}]),await u()});async function u(){C.value=!0;try{const a=await E.getUsers({page:w.value,pageSize:h.value,keyword:r.keyword||void 0,role:r.role||void 0});if(a.code===200&&a.data){const o=a.data;V.value=o.items,M.value=o.total}}finally{C.value=!1}}function N(){r.role="",r.keyword="",w.value=1,u()}function P(a){return a.split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2)}function j(a){return{end_user:"End User",support_staff:"Support Staff",manager:"Manager",admin:"Administrator"}[a]||a}function q(a){return{end_user:"info",support_staff:"success",manager:"warning",admin:"danger"}[a]||""}function K(){_.info("Add user dialog would open here")}function T(a){_.info(`Edit user: ${a.name}`)}function H(a){$.value=a,g.role=a.role,v.value=!0}async function X(){if($.value)try{const a=await E.updateUserRole($.value.id,g.role);a.code===200?(_.success("Role updated successfully"),v.value=!1,await u()):_.error(a.message)}catch{_.error("Failed to update role")}}async function Y(a){try{await pe.confirm(`Are you sure you want to delete user "${a.name}"?`,"Delete User",{type:"warning"}),_.success(`User ${a.name} deleted (mock)`)}catch{}}return(a,o)=>{const U=n("el-icon"),i=n("el-button"),p=n("el-option"),S=n("el-select"),b=n("el-form-item"),G=n("el-input"),R=n("el-form"),z=n("el-card"),J=n("el-avatar"),f=n("el-table-column"),A=n("el-tag"),L=n("el-table"),O=n("el-pagination"),Q=n("el-dialog"),W=se("loading");return I(),le("div",fe,[m("div",_e,[m("h1",null,s(a.$t("admin.userManagement")),1),e(i,{type:"primary",onClick:K},{default:l(()=>[e(U,null,{default:l(()=>[e(y(te))]),_:1}),d(" "+s(a.$t("admin.addUser")),1)]),_:1})]),e(z,{class:"filter-card"},{default:l(()=>[e(R,{inline:!0,model:r,class:"filter-form"},{default:l(()=>[e(b,{label:a.$t("admin.userRole")},{default:l(()=>[e(S,{modelValue:r.role,"onUpdate:modelValue":o[0]||(o[0]=t=>r.role=t),placeholder:a.$t("admin.filterByRole"),clearable:"",onChange:u},{default:l(()=>[e(p,{label:a.$t("roles.endUser"),value:"end_user"},null,8,["label"]),e(p,{label:a.$t("roles.supportStaff"),value:"support_staff"},null,8,["label"]),e(p,{label:a.$t("roles.manager"),value:"manager"},null,8,["label"]),e(p,{label:a.$t("roles.admin"),value:"admin"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(b,{label:a.$t("common.search")},{default:l(()=>[e(G,{modelValue:r.keyword,"onUpdate:modelValue":o[1]||(o[1]=t=>r.keyword=t),placeholder:a.$t("admin.searchUsers"),clearable:"",onKeyup:oe(u,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(b,null,{default:l(()=>[e(i,{type:"primary",onClick:u},{default:l(()=>[d(s(a.$t("common.search")),1)]),_:1}),e(i,{onClick:N},{default:l(()=>[d(s(a.$t("common.reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(z,{class:"table-card"},{default:l(()=>[ne((I(),re(L,{data:V.value},{default:l(()=>[e(f,{prop:"name",label:a.$t("common.name"),"min-width":"180"},{default:l(({row:t})=>[m("div",ve,[e(J,{size:36,src:t.avatar},{default:l(()=>[d(s(P(t.name)),1)]),_:2},1032,["src"]),m("div",ge,[m("span",be,s(t.name),1),m("span",ye,s(t.email),1)])])]),_:1},8,["label"]),e(f,{prop:"role",label:a.$t("admin.userRole"),width:"140"},{default:l(({row:t})=>[e(A,{type:q(t.role)},{default:l(()=>[d(s(j(t.role)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(f,{prop:"department",label:a.$t("profile.department"),width:"150"},null,8,["label"]),e(f,{prop:"status",label:a.$t("common.status"),width:"100"},{default:l(({row:t})=>[e(A,{type:t.status==="active"?"success":"danger",size:"small"},{default:l(()=>[d(s(t.status==="active"?a.$t("admin.active"):a.$t("admin.inactive")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(f,{prop:"createdAt",label:a.$t("profile.joined"),width:"130"},{default:l(({row:t})=>[d(s(y(me)(t.createdAt)),1)]),_:1},8,["label"]),e(f,{label:a.$t("common.actions"),width:"150",fixed:"right"},{default:l(({row:t})=>[e(i,{text:"",type:"primary",onClick:B=>T(t)},{default:l(()=>[e(U,null,{default:l(()=>[e(y(de))]),_:1})]),_:1},8,["onClick"]),e(i,{text:"",type:"warning",onClick:B=>H(t)},{default:l(()=>[e(U,null,{default:l(()=>[e(y(ue))]),_:1})]),_:1},8,["onClick"]),e(i,{text:"",type:"danger",onClick:B=>Y(t)},{default:l(()=>[e(U,null,{default:l(()=>[e(y(ie))]),_:1})]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[W,C.value]]),m("div",we,[e(O,{"current-page":w.value,"onUpdate:currentPage":o[2]||(o[2]=t=>w.value=t),"page-size":h.value,"onUpdate:pageSize":o[3]||(o[3]=t=>h.value=t),total:M.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",onSizeChange:u,onCurrentChange:u},null,8,["current-page","page-size","total"])])]),_:1}),e(Q,{modelValue:v.value,"onUpdate:modelValue":o[6]||(o[6]=t=>v.value=t),title:"Change User Role",width:"400px"},{footer:l(()=>[e(i,{onClick:o[5]||(o[5]=t=>v.value=!1)},{default:l(()=>[...o[7]||(o[7]=[d("Cancel",-1)])]),_:1}),e(i,{type:"primary",onClick:X},{default:l(()=>[...o[8]||(o[8]=[d("Confirm",-1)])]),_:1})]),default:l(()=>[e(R,{model:g,"label-width":"80px"},{default:l(()=>[e(b,{label:"User"},{default:l(()=>[m("span",null,s($.value?.name),1)]),_:1}),e(b,{label:"Role"},{default:l(()=>[e(S,{modelValue:g.role,"onUpdate:modelValue":o[4]||(o[4]=t=>g.role=t),style:{width:"100%"}},{default:l(()=>[e(p,{label:"End User",value:"end_user"}),e(p,{label:"Support Staff",value:"support_staff"}),e(p,{label:"Manager",value:"manager"}),e(p,{label:"Administrator",value:"admin"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Ve=ce($e,[["__scopeId","data-v-025faf56"]]);export{Ve as default};
