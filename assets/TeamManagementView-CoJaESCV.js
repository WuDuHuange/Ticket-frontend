import{d as W,k as Y,l as Z,r as _,aa as x,o as ee,c as C,e as d,p as ae,f as a,t as o,w as t,g as s,X as te,q as w,y as r,i as c,B as ne,F as U,O as E,H as oe,aq as le,ao as se,G as ie,ap as de,s as me,E as $,a9 as re,h as u}from"./index-C3uyuHtt.js";import{m as q}from"./index-BrCbebx6.js";import{f as ce}from"./helpers-BtQK9j-g.js";import{_ as ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./tickets-CV57FQXZ.js";const pe={class:"team-management-view"},fe={class:"page-header"},_e={class:"team-header"},ve={class:"team-icon"},ge={class:"team-info"},be={class:"member-count"},we={class:"team-description"},$e={class:"team-members"},ye={class:"team-footer"},ke={class:"created-date"},Te=W({__name:"TeamManagementView",setup(he){const{t:m}=Y(),I=Z(),y=_(!1),k=_(!1),V=_([]),p=_(!1),v=_(!1),T=_(),l=x({id:"",name:"",description:""}),z={name:[{required:!0,message:()=>m("admin.teamNameRequired"),trigger:"blur"}]};ee(async()=>{I.setBreadcrumbs([{label:m("nav.administration")},{label:m("nav.teamManagement")}]),await M()});async function M(){y.value=!0;try{const e=await q.getTeams();e.code===200&&e.data&&(V.value=e.data)}finally{y.value=!1}}function F(e){return e.split(" ").map(i=>i[0]).join("").toUpperCase().slice(0,2)}function R(){v.value=!1,l.id="",l.name="",l.description="",p.value=!0}function S(e){v.value=!0,l.id=e.id,l.name=e.name,l.description=e.description||"",p.value=!0}function A(e){$.info(`${m("admin.manageMembers")}: ${e.name}`)}async function H(e){try{await re.confirm(`${m("admin.confirmDeleteTeam")} "${e.name}"?`,m("admin.deleteTeam"),{type:"warning"}),$.success(m("admin.teamDeleted"))}catch{}}async function j(){T.value&&await T.value.validate(async e=>{if(e){k.value=!0;try{v.value?$.success(m("admin.teamUpdated")):(await q.createTeam({name:l.name,description:l.description})).code===200&&($.success(m("admin.teamCreated")),await M()),p.value=!1}finally{k.value=!1}}})}return(e,i)=>{const f=s("el-icon"),b=s("el-button"),h=s("el-dropdown-item"),G=s("el-dropdown-menu"),L=s("el-dropdown"),D=s("el-avatar"),O=s("el-card"),X=s("el-col"),J=s("el-row"),B=s("el-input"),N=s("el-form-item"),K=s("el-form"),P=s("el-dialog"),Q=te("loading");return u(),C("div",pe,[d("div",fe,[d("h1",null,o(e.$t("nav.teamManagement")),1),a(b,{type:"primary",onClick:R},{default:t(()=>[a(f,null,{default:t(()=>[a(c(ne))]),_:1}),r(" "+o(e.$t("admin.addTeam")),1)]),_:1})]),ae((u(),w(J,{gutter:20},{default:t(()=>[(u(!0),C(U,null,E(V.value,n=>(u(),w(X,{xs:24,sm:12,lg:8,key:n.id},{default:t(()=>[a(O,{class:"team-card"},{default:t(()=>[d("div",_e,[d("div",ve,[a(f,{size:32},{default:t(()=>[a(c(oe))]),_:1})]),d("div",ge,[d("h3",null,o(n.name),1),d("span",be,o(n.memberCount)+" "+o(e.$t("admin.teamMembers")),1)]),a(L,{trigger:"click"},{dropdown:t(()=>[a(G,null,{default:t(()=>[a(h,{onClick:g=>S(n)},{default:t(()=>[a(f,null,{default:t(()=>[a(c(se))]),_:1}),r(" "+o(e.$t("common.edit")),1)]),_:1},8,["onClick"]),a(h,{onClick:g=>A(n)},{default:t(()=>[a(f,null,{default:t(()=>[a(c(ie))]),_:1}),r(" "+o(e.$t("admin.manageMembers")),1)]),_:1},8,["onClick"]),a(h,{divided:"",onClick:g=>H(n)},{default:t(()=>[a(f,null,{default:t(()=>[a(c(de))]),_:1}),r(" "+o(e.$t("common.delete")),1)]),_:1},8,["onClick"])]),_:2},1024)]),default:t(()=>[a(b,{text:""},{default:t(()=>[a(f,null,{default:t(()=>[a(c(le))]),_:1})]),_:1})]),_:2},1024)]),d("p",we,o(n.description||e.$t("admin.noDescription")),1),d("div",$e,[(u(!0),C(U,null,E(n.members?.slice(0,5),g=>(u(),w(D,{key:g.id,size:32,class:"member-avatar"},{default:t(()=>[r(o(F(g.userName)),1)]),_:2},1024))),128)),n.memberCount>5?(u(),w(D,{key:0,size:32,class:"member-avatar more"},{default:t(()=>[r(" +"+o(n.memberCount-5),1)]),_:2},1024)):me("",!0)]),d("div",ye,[d("span",ke,o(e.$t("admin.createdDate"))+" "+o(c(ce)(n.createdAt)),1)])]),_:2},1024)]),_:2},1024))),128))]),_:1})),[[Q,y.value]]),a(P,{modelValue:p.value,"onUpdate:modelValue":i[3]||(i[3]=n=>p.value=n),title:v.value?e.$t("admin.editTeam"):e.$t("admin.addTeam"),width:"500px"},{footer:t(()=>[a(b,{onClick:i[2]||(i[2]=n=>p.value=!1)},{default:t(()=>[r(o(e.$t("common.cancel")),1)]),_:1}),a(b,{type:"primary",onClick:j,loading:k.value},{default:t(()=>[r(o(v.value?e.$t("admin.updateTeam"):e.$t("admin.createTeam")),1)]),_:1},8,["loading"])]),default:t(()=>[a(K,{model:l,rules:z,ref_key:"formRef",ref:T,"label-width":"100px"},{default:t(()=>[a(N,{label:e.$t("common.name"),prop:"name"},{default:t(()=>[a(B,{modelValue:l.name,"onUpdate:modelValue":i[0]||(i[0]=n=>l.name=n),placeholder:e.$t("admin.enterTeamName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(N,{label:e.$t("common.description"),prop:"description"},{default:t(()=>[a(B,{modelValue:l.description,"onUpdate:modelValue":i[1]||(i[1]=n=>l.description=n),type:"textarea",rows:3,placeholder:e.$t("admin.enterTeamDescription")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Ne=ue(Te,[["__scopeId","data-v-bf6dbbbb"]]);export{Ne as default};
