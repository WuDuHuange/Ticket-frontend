import{d as x,p as ee,q as te,s as g,r as P,a0 as le,X as se,c as ae,a as n,b as t,t as i,w as s,e as r,o as z,i as d,h as _,D as oe,Q as $,P as ie,v as ne,_ as re,y as I,z as ue,f as de}from"./index-Myl3Wffr.js";import{u as ce}from"./ticket-b3rCwkfE.js";import{g as pe,a as me,f as ve,b as fe}from"./helpers-BtW4N_bD.js";import{_ as ge}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ke={class:"ticket-list-view"},_e={class:"page-header"},be={class:"stat-value"},ye={class:"stat-label"},we={class:"stat-value"},he={class:"stat-label"},$e={class:"stat-value"},Ce={class:"stat-label"},Te={class:"stat-value"},Ve={class:"stat-label"},Pe={class:"ticket-title"},ze={class:"pagination-wrapper"},Se=x({__name:"TicketListView",setup(Ne){const S=de(),{t:c}=ee(),m=ce(),A=te(),D=g(()=>m.loading),R=g(()=>m.tickets),v=P(1),b=P(10),f=P("all"),N=g(()=>m.pagination.total),L=g(()=>m.newTickets.length),M=g(()=>m.tickets.filter(e=>e.status==="in_progress").length),q=g(()=>m.resolvedTickets.length),o=le({status:[],priority:[],keyword:""});function F(e){return{new:c("tickets.statusNew"),assigned:c("tickets.statusAssigned"),in_progress:c("tickets.statusInProgress"),pending_user:c("tickets.statusPendingUser"),resolved:c("tickets.statusResolved"),closed:c("tickets.statusClosed")}[e]||e}se(async()=>{A.setBreadcrumbs([{label:c("nav.dashboard"),path:"/"},{label:c("nav.allTickets")}]),await k()});function K(){S.push("/tickets/create")}function j(e){S.push(`/tickets/${e.id}`)}function y(e){f.value=e,e==="all"?o.status=[]:e==="new"?o.status=["new"]:e==="in_progress"?o.status=["assigned","in_progress","pending_user"]:e==="resolved"&&(o.status=["resolved","closed"]),C()}async function k(){const e={};o.status.length>0&&(e.status=o.status),o.priority.length>0&&(e.priority=o.priority),o.keyword&&(e.keyword=o.keyword),await m.fetchTickets(v.value,b.value,e)}async function C(){v.value=1,await k()}async function E(){o.status=[],o.priority=[],o.keyword="",f.value="all",v.value=1,await k()}async function H(e){b.value=e,v.value=1,await k()}async function Q(e){v.value=e,await k()}return(e,a)=>{const X=r("el-icon"),T=r("el-button"),w=r("el-col"),G=r("el-row"),u=r("el-option"),B=r("el-select"),h=r("el-form-item"),J=r("el-input"),O=r("el-form"),U=r("el-card"),p=r("el-table-column"),V=r("el-tag"),W=r("el-table"),Y=r("el-pagination"),Z=re("loading");return z(),ae("div",ke,[n("div",_e,[n("h1",null,i(e.$t("tickets.allTickets")),1),t(T,{type:"primary",onClick:K},{default:s(()=>[t(X,null,{default:s(()=>[t(_(oe))]),_:1}),d(" "+i(e.$t("dashboard.newTicket")),1)]),_:1})]),t(G,{gutter:16,class:"stats-row"},{default:s(()=>[t(w,{xs:12,sm:6},{default:s(()=>[n("div",{class:$(["stat-item",{active:f.value==="all"}]),onClick:a[0]||(a[0]=l=>y("all"))},[n("div",be,i(N.value),1),n("div",ye,i(e.$t("tickets.allTickets")),1)],2)]),_:1}),t(w,{xs:12,sm:6},{default:s(()=>[n("div",{class:$(["stat-item",{active:f.value==="new"}]),onClick:a[1]||(a[1]=l=>y("new"))},[n("div",we,i(L.value),1),n("div",he,i(e.$t("tickets.statusNew")),1)],2)]),_:1}),t(w,{xs:12,sm:6},{default:s(()=>[n("div",{class:$(["stat-item",{active:f.value==="in_progress"}]),onClick:a[2]||(a[2]=l=>y("in_progress"))},[n("div",$e,i(M.value),1),n("div",Ce,i(e.$t("tickets.statusInProgress")),1)],2)]),_:1}),t(w,{xs:12,sm:6},{default:s(()=>[n("div",{class:$(["stat-item",{active:f.value==="resolved"}]),onClick:a[3]||(a[3]=l=>y("resolved"))},[n("div",Te,i(q.value),1),n("div",Ve,i(e.$t("tickets.statusResolved")),1)],2)]),_:1})]),_:1}),t(U,{class:"filter-card"},{default:s(()=>[t(O,{inline:!0,model:o,class:"filter-form"},{default:s(()=>[t(h,{label:e.$t("common.status")},{default:s(()=>[t(B,{modelValue:o.status,"onUpdate:modelValue":a[4]||(a[4]=l=>o.status=l),placeholder:e.$t("tickets.filterByStatus"),clearable:"",multiple:"","collapse-tags":""},{default:s(()=>[t(u,{label:e.$t("tickets.statusNew"),value:"new"},null,8,["label"]),t(u,{label:e.$t("tickets.statusAssigned"),value:"assigned"},null,8,["label"]),t(u,{label:e.$t("tickets.statusInProgress"),value:"in_progress"},null,8,["label"]),t(u,{label:e.$t("tickets.statusPendingUser"),value:"pending_user"},null,8,["label"]),t(u,{label:e.$t("tickets.statusResolved"),value:"resolved"},null,8,["label"]),t(u,{label:e.$t("tickets.statusClosed"),value:"closed"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(h,{label:e.$t("common.priority")},{default:s(()=>[t(B,{modelValue:o.priority,"onUpdate:modelValue":a[5]||(a[5]=l=>o.priority=l),placeholder:e.$t("tickets.filterByPriority"),clearable:"",multiple:"","collapse-tags":""},{default:s(()=>[t(u,{label:e.$t("tickets.priorityLow"),value:"low"},null,8,["label"]),t(u,{label:e.$t("tickets.priorityMedium"),value:"medium"},null,8,["label"]),t(u,{label:e.$t("tickets.priorityHigh"),value:"high"},null,8,["label"]),t(u,{label:e.$t("tickets.priorityUrgent"),value:"urgent"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(h,{label:e.$t("common.search")},{default:s(()=>[t(J,{modelValue:o.keyword,"onUpdate:modelValue":a[6]||(a[6]=l=>o.keyword=l),placeholder:e.$t("tickets.searchTickets"),clearable:"",onKeyup:ie(C,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(h,null,{default:s(()=>[t(T,{type:"primary",onClick:C},{default:s(()=>[d(i(e.$t("common.search")),1)]),_:1}),t(T,{onClick:E},{default:s(()=>[d(i(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(U,{class:"table-card"},{default:s(()=>[ne((z(),I(W,{data:R.value,style:{width:"100%"},onRowClick:j,"row-class-name":"clickable-row"},{default:s(()=>[t(p,{prop:"id",label:e.$t("tickets.ticketId"),width:"150"},null,8,["label"]),t(p,{prop:"title",label:e.$t("common.title"),"min-width":"200"},{default:s(({row:l})=>[n("div",Pe,[n("span",null,i(l.title),1),l.slaBreached?(z(),I(V,{key:0,type:"danger",size:"small"},{default:s(()=>[...a[9]||(a[9]=[d("SLA",-1)])]),_:1})):ue("",!0)])]),_:1},8,["label"]),t(p,{prop:"requesterName",label:e.$t("tickets.submittedBy"),width:"150"},null,8,["label"]),t(p,{prop:"category",label:e.$t("common.category"),width:"130"},{default:s(({row:l})=>[d(i(l.category?.name||"N/A"),1)]),_:1},8,["label"]),t(p,{prop:"status",label:e.$t("common.status"),width:"120"},{default:s(({row:l})=>[t(V,{type:_(pe)(l.status),size:"small"},{default:s(()=>[d(i(F(l.status)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(p,{prop:"priority",label:e.$t("common.priority"),width:"100"},{default:s(({row:l})=>[t(V,{type:_(me)(l.priority),size:"small",effect:"plain"},{default:s(()=>[d(i(_(ve)(l.priority)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(p,{prop:"assigneeName",label:e.$t("tickets.assignedTo"),width:"130"},{default:s(({row:l})=>[d(i(l.assigneeName||e.$t("tickets.unassigned")),1)]),_:1},8,["label"]),t(p,{prop:"createdAt",label:e.$t("common.created"),width:"130"},{default:s(({row:l})=>[d(i(_(fe)(l.createdAt)),1)]),_:1},8,["label"])]),_:1},8,["data"])),[[Z,D.value]]),n("div",ze,[t(Y,{"current-page":v.value,"onUpdate:currentPage":a[7]||(a[7]=l=>v.value=l),"page-size":b.value,"onUpdate:pageSize":a[8]||(a[8]=l=>b.value=l),total:N.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:Q},null,8,["current-page","page-size","total"])])]),_:1})])}}}),De=ge(Se,[["__scopeId","data-v-5286cfa6"]]);export{De as default};
