import{d as E,k as L,l as q,p as v,ai as G,o as H,ak as J,c as O,e as g,f as t,t as i,w as l,g as s,A as u,i as f,F as Q,U as W,s as X,a2 as Y,x as T,y as Z,b as x,h}from"./index-Bo1QE9TC.js";import{u as ee}from"./ticket-Cd9x3L1M.js";import{g as te,a as ae,b as le,f as se,d as oe}from"./helpers-BtQK9j-g.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ie={class:"my-tickets-view"},re={class:"page-header"},ce={class:"ticket-title"},ue={class:"pagination-wrapper"},de=E({__name:"MyTicketsView",setup(pe){const w=x(),{t:d}=L(),r=ee(),C=q(),S=v(()=>r.loading),z=v(()=>r.tickets),c=v(()=>r.pagination),o=G({status:"",keyword:""});function V(e){return{new:d("tickets.statusNew"),assigned:d("tickets.statusAssigned"),in_progress:d("tickets.statusInProgress"),pending_user:d("tickets.statusPendingUser"),resolved:d("tickets.statusResolved"),closed:d("tickets.statusClosed")}[e]||e}H(async()=>{C.setBreadcrumbs([{label:d("nav.dashboard"),path:"/"},{label:d("nav.myTickets")}]),await r.fetchMyTickets(1,10)}),J(async()=>{await r.fetchMyTickets(1,c.value.pageSize||10,o.status||void 0)});function M(){w.push("/tickets/create")}function A(e){w.push(`/tickets/${e.id}`)}async function _(){await r.fetchMyTickets(1,c.value.pageSize,o.status||void 0)}async function P(){o.status="",o.keyword="",await r.fetchMyTickets(1,c.value.pageSize)}async function U(e){await r.fetchMyTickets(1,e,o.status||void 0)}async function B(e){await r.fetchMyTickets(e,c.value.pageSize,o.status||void 0)}return(e,n)=>{const N=s("el-icon"),k=s("el-button"),m=s("el-option"),I=s("el-select"),y=s("el-form-item"),R=s("el-input"),D=s("el-form"),$=s("el-card"),p=s("el-table-column"),b=s("el-tag"),F=s("el-table"),K=s("el-pagination"),j=Y("loading");return h(),O("div",ie,[g("div",re,[g("h1",null,i(e.$t("tickets.myTickets")),1),t(k,{type:"primary",onClick:M},{default:l(()=>[t(N,null,{default:l(()=>[t(f(Q))]),_:1}),u(" "+i(e.$t("dashboard.newTicket")),1)]),_:1})]),t($,{class:"filter-card"},{default:l(()=>[t(D,{inline:!0,model:o,class:"filter-form"},{default:l(()=>[t(y,{label:e.$t("common.status")},{default:l(()=>[t(I,{modelValue:o.status,"onUpdate:modelValue":n[0]||(n[0]=a=>o.status=a),placeholder:e.$t("tickets.filterByStatus"),clearable:"",onChange:_},{default:l(()=>[t(m,{label:e.$t("tickets.statusNew"),value:"new"},null,8,["label"]),t(m,{label:e.$t("tickets.statusAssigned"),value:"assigned"},null,8,["label"]),t(m,{label:e.$t("tickets.statusInProgress"),value:"in_progress"},null,8,["label"]),t(m,{label:e.$t("tickets.statusPendingUser"),value:"pending_user"},null,8,["label"]),t(m,{label:e.$t("tickets.statusResolved"),value:"resolved"},null,8,["label"]),t(m,{label:e.$t("tickets.statusClosed"),value:"closed"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(y,{label:e.$t("common.search")},{default:l(()=>[t(R,{modelValue:o.keyword,"onUpdate:modelValue":n[1]||(n[1]=a=>o.keyword=a),placeholder:e.$t("tickets.searchTickets"),clearable:"",onKeyup:W(_,["enter"]),onClear:_},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(y,null,{default:l(()=>[t(k,{type:"primary",onClick:_},{default:l(()=>[u(i(e.$t("common.search")),1)]),_:1}),t(k,{onClick:P},{default:l(()=>[u(i(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t($,{class:"table-card"},{default:l(()=>[X((h(),T(F,{data:z.value,style:{width:"100%"},onRowClick:A,"row-class-name":"clickable-row"},{default:l(()=>[t(p,{prop:"id",label:e.$t("tickets.ticketId"),width:"150"},null,8,["label"]),t(p,{prop:"title",label:e.$t("common.title"),"min-width":"250"},{default:l(({row:a})=>[g("div",ce,[g("span",null,i(a.title),1),a.slaBreached?(h(),T(b,{key:0,type:"danger",size:"small"},{default:l(()=>[...n[4]||(n[4]=[u("SLA",-1)])]),_:1})):Z("",!0)])]),_:1},8,["label"]),t(p,{prop:"category",label:e.$t("common.category"),width:"150"},{default:l(({row:a})=>[u(i(a.category?.name||"N/A"),1)]),_:1},8,["label"]),t(p,{prop:"status",label:e.$t("common.status"),width:"130"},{default:l(({row:a})=>[t(b,{type:f(te)(a.status),size:"small"},{default:l(()=>[u(i(V(a.status)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(p,{prop:"priority",label:e.$t("common.priority"),width:"110"},{default:l(({row:a})=>[t(b,{type:f(ae)(a.priority),size:"small",effect:"plain"},{default:l(()=>[u(i(f(le)(a.priority)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(p,{prop:"createdAt",label:e.$t("common.created"),width:"140"},{default:l(({row:a})=>[u(i(f(se)(a.createdAt)),1)]),_:1},8,["label"]),t(p,{prop:"updatedAt",label:e.$t("common.updated"),width:"140"},{default:l(({row:a})=>[u(i(f(oe)(a.updatedAt)),1)]),_:1},8,["label"])]),_:1},8,["data"])),[[j,S.value]]),g("div",ue,[t(K,{"current-page":c.value.page,"onUpdate:currentPage":n[2]||(n[2]=a=>c.value.page=a),"page-size":c.value.pageSize,"onUpdate:pageSize":n[3]||(n[3]=a=>c.value.pageSize=a),total:c.value.total,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:U,onCurrentChange:B},null,8,["current-page","page-size","total"])])]),_:1})])}}}),ke=ne(de,[["__scopeId","data-v-96fa4b5e"]]);export{ke as default};
