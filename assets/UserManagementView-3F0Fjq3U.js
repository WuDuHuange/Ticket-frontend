import{d as re,k as ue,l as de,r as i,ad as B,o as ie,ar as T,c as me,e as v,f as l,t as r,w as a,g as n,y as m,i as V,B as pe,R as fe,p as ce,$ as ve,q as G,as as ge,I as be,at as _e,s as ye,E as g,ac as $e,h as D}from"./index-DaxlKADp.js";import{f as we}from"./helpers-BtQK9j-g.js";import{_ as Ue}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ve={class:"user-management-view"},Ce={class:"page-header"},ke={class:"user-info"},he={class:"user-details"},Re={class:"user-name"},Me={class:"user-email"},Se={class:"pagination-wrapper"},ze=re({__name:"UserManagementView",setup(Fe){const{t:E}=ue(),H=de(),R=i(!1),A=i([]),C=i(1),M=i(10),q=i(0),f=B({role:"",keyword:""}),$=i(!1),k=i(null),w=B({role:""}),b=i(!1),_=i(!1),S=i(!1),z=i(),s=B({id:"",name:"",email:"",password:"",role:"end_user",department:"",status:"active"}),J={name:[{required:!0,message:"Please enter user name",trigger:"blur"}],email:[{required:!0,message:"Please enter email",trigger:"blur"},{type:"email",message:"Please enter valid email",trigger:"blur"}],password:[{required:!0,message:"Please enter password",trigger:"blur"},{min:6,message:"Password must be at least 6 characters",trigger:"blur"}],role:[{required:!0,message:"Please select role",trigger:"change"}]};ie(async()=>{H.setBreadcrumbs([{label:E("nav.administration")},{label:E("nav.userManagement")}]),await c()});async function c(){R.value=!0;try{const e=await T.getUsers({page:C.value,pageSize:M.value,keyword:f.keyword||void 0,role:f.role||void 0});if(e.code===200&&e.data){const o=e.data;A.value=o.items,q.value=o.total}}catch(e){console.error("Failed to load users:",e)}finally{R.value=!1}}function L(){f.role="",f.keyword="",C.value=1,c()}function O(e){return e.split(" ").map(o=>o[0]).join("").toUpperCase().slice(0,2)}function Q(e){return{end_user:"End User",support_staff:"Support Staff",manager:"Manager",admin:"Administrator"}[e]||e}function W(e){return{end_user:"info",support_staff:"success",manager:"warning",admin:"danger"}[e]||""}function X(){_.value=!1,s.id="",s.name="",s.email="",s.password="",s.role="end_user",s.department="",s.status="active",b.value=!0}function Y(e){_.value=!0,s.id=e.id,s.name=e.name,s.email=e.email,s.password="",s.role=e.role,s.department=e.department||"",s.status=e.status||"active",b.value=!0}async function Z(){z.value&&await z.value.validate(async e=>{if(e){S.value=!0;try{_.value?g.success("User updated successfully"):g.success("User created successfully"),b.value=!1,await c()}catch(o){console.error("Failed to save user:",o),g.error("Failed to save user")}finally{S.value=!1}}})}function x(e){k.value=e,w.role=e.role,$.value=!0}async function ee(){if(k.value)try{const e=await T.updateUserRole(k.value.id,w.role);e.code===200?(g.success("Role updated successfully"),$.value=!1,await c()):g.error(e.message)}catch{g.error("Failed to update role")}}async function le(e){try{await $e.confirm(`Are you sure you want to delete user "${e.name}"?`,"Delete User",{type:"warning"}),g.success(`User ${e.name} deleted (mock)`)}catch{}}return(e,o)=>{const h=n("el-icon"),p=n("el-button"),u=n("el-option"),F=n("el-select"),d=n("el-form-item"),U=n("el-input"),P=n("el-form"),I=n("el-card"),ae=n("el-avatar"),y=n("el-table-column"),N=n("el-tag"),te=n("el-table"),oe=n("el-pagination"),j=n("el-dialog"),se=n("el-switch"),ne=ve("loading");return D(),me("div",Ve,[v("div",Ce,[v("h1",null,r(e.$t("admin.userManagement")),1),l(p,{type:"primary",onClick:X},{default:a(()=>[l(h,null,{default:a(()=>[l(V(pe))]),_:1}),m(" "+r(e.$t("admin.addUser")),1)]),_:1})]),l(I,{class:"filter-card"},{default:a(()=>[l(P,{inline:!0,model:f,class:"filter-form"},{default:a(()=>[l(d,{label:e.$t("admin.userRole")},{default:a(()=>[l(F,{modelValue:f.role,"onUpdate:modelValue":o[0]||(o[0]=t=>f.role=t),placeholder:e.$t("admin.filterByRole"),clearable:"",onChange:c},{default:a(()=>[l(u,{label:e.$t("roles.endUser"),value:"end_user"},null,8,["label"]),l(u,{label:e.$t("roles.supportStaff"),value:"support_staff"},null,8,["label"]),l(u,{label:e.$t("roles.manager"),value:"manager"},null,8,["label"]),l(u,{label:e.$t("roles.admin"),value:"admin"},null,8,["label"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,{label:e.$t("common.search")},{default:a(()=>[l(U,{modelValue:f.keyword,"onUpdate:modelValue":o[1]||(o[1]=t=>f.keyword=t),placeholder:e.$t("admin.searchUsers"),clearable:"",onKeyup:fe(c,["enter"])},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,null,{default:a(()=>[l(p,{type:"primary",onClick:c},{default:a(()=>[m(r(e.$t("common.search")),1)]),_:1}),l(p,{onClick:L},{default:a(()=>[m(r(e.$t("common.reset")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),l(I,{class:"table-card"},{default:a(()=>[ce((D(),G(te,{data:A.value},{default:a(()=>[l(y,{prop:"name",label:e.$t("common.name"),"min-width":"180"},{default:a(({row:t})=>[v("div",ke,[l(ae,{size:36,src:t.avatar},{default:a(()=>[m(r(O(t.name)),1)]),_:2},1032,["src"]),v("div",he,[v("span",Re,r(t.name),1),v("span",Me,r(t.email),1)])])]),_:1},8,["label"]),l(y,{prop:"role",label:e.$t("admin.userRole"),width:"140"},{default:a(({row:t})=>[l(N,{type:W(t.role)},{default:a(()=>[m(r(Q(t.role)),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(y,{prop:"department",label:e.$t("profile.department"),width:"150"},null,8,["label"]),l(y,{prop:"status",label:e.$t("common.status"),width:"100"},{default:a(({row:t})=>[l(N,{type:t.status==="active"?"success":"danger",size:"small"},{default:a(()=>[m(r(t.status==="active"?e.$t("admin.active"):e.$t("admin.inactive")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),l(y,{prop:"createdAt",label:e.$t("profile.joined"),width:"130"},{default:a(({row:t})=>[m(r(V(we)(t.createdAt)),1)]),_:1},8,["label"]),l(y,{label:e.$t("common.actions"),width:"150",fixed:"right"},{default:a(({row:t})=>[l(p,{text:"",type:"primary",onClick:K=>Y(t)},{default:a(()=>[l(h,null,{default:a(()=>[l(V(ge))]),_:1})]),_:1},8,["onClick"]),l(p,{text:"",type:"warning",onClick:K=>x(t)},{default:a(()=>[l(h,null,{default:a(()=>[l(V(be))]),_:1})]),_:1},8,["onClick"]),l(p,{text:"",type:"danger",onClick:K=>le(t)},{default:a(()=>[l(h,null,{default:a(()=>[l(V(_e))]),_:1})]),_:1},8,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[ne,R.value]]),v("div",Se,[l(oe,{"current-page":C.value,"onUpdate:currentPage":o[2]||(o[2]=t=>C.value=t),"page-size":M.value,"onUpdate:pageSize":o[3]||(o[3]=t=>M.value=t),total:q.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",onSizeChange:c,onCurrentChange:c},null,8,["current-page","page-size","total"])])]),_:1}),l(j,{modelValue:$.value,"onUpdate:modelValue":o[6]||(o[6]=t=>$.value=t),title:"Change User Role",width:"400px"},{footer:a(()=>[l(p,{onClick:o[5]||(o[5]=t=>$.value=!1)},{default:a(()=>[...o[15]||(o[15]=[m("Cancel",-1)])]),_:1}),l(p,{type:"primary",onClick:ee},{default:a(()=>[...o[16]||(o[16]=[m("Confirm",-1)])]),_:1})]),default:a(()=>[l(P,{model:w,"label-width":"80px"},{default:a(()=>[l(d,{label:"User"},{default:a(()=>[v("span",null,r(k.value?.name),1)]),_:1}),l(d,{label:"Role"},{default:a(()=>[l(F,{modelValue:w.role,"onUpdate:modelValue":o[4]||(o[4]=t=>w.role=t),style:{width:"100%"}},{default:a(()=>[l(u,{label:"End User",value:"end_user"}),l(u,{label:"Support Staff",value:"support_staff"}),l(u,{label:"Manager",value:"manager"}),l(u,{label:"Administrator",value:"admin"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(j,{modelValue:b.value,"onUpdate:modelValue":o[14]||(o[14]=t=>b.value=t),title:_.value?e.$t("admin.editUser"):e.$t("admin.addUser"),width:"500px"},{footer:a(()=>[l(p,{onClick:o[13]||(o[13]=t=>b.value=!1)},{default:a(()=>[m(r(e.$t("common.cancel")),1)]),_:1}),l(p,{type:"primary",onClick:Z,loading:S.value},{default:a(()=>[m(r(_.value?e.$t("common.save"):e.$t("common.add")),1)]),_:1},8,["loading"])]),default:a(()=>[l(P,{model:s,rules:J,ref_key:"userFormRef",ref:z,"label-width":"120px"},{default:a(()=>[l(d,{label:e.$t("common.name"),prop:"name"},{default:a(()=>[l(U,{modelValue:s.name,"onUpdate:modelValue":o[7]||(o[7]=t=>s.name=t),placeholder:e.$t("admin.enterUserName")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,{label:e.$t("common.email"),prop:"email"},{default:a(()=>[l(U,{modelValue:s.email,"onUpdate:modelValue":o[8]||(o[8]=t=>s.email=t),type:"email",placeholder:e.$t("admin.enterUserEmail")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),_.value?ye("",!0):(D(),G(d,{key:0,label:e.$t("auth.password"),prop:"password"},{default:a(()=>[l(U,{modelValue:s.password,"onUpdate:modelValue":o[9]||(o[9]=t=>s.password=t),type:"password","show-password":"",placeholder:e.$t("admin.enterPassword")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])),l(d,{label:e.$t("admin.userRole"),prop:"role"},{default:a(()=>[l(F,{modelValue:s.role,"onUpdate:modelValue":o[10]||(o[10]=t=>s.role=t),style:{width:"100%"}},{default:a(()=>[l(u,{label:e.$t("roles.endUser"),value:"end_user"},null,8,["label"]),l(u,{label:e.$t("roles.supportStaff"),value:"support_staff"},null,8,["label"]),l(u,{label:e.$t("roles.manager"),value:"manager"},null,8,["label"]),l(u,{label:e.$t("roles.admin"),value:"admin"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),l(d,{label:e.$t("profile.department"),prop:"department"},{default:a(()=>[l(U,{modelValue:s.department,"onUpdate:modelValue":o[11]||(o[11]=t=>s.department=t),placeholder:e.$t("admin.enterDepartment")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,{label:e.$t("common.status"),prop:"status"},{default:a(()=>[l(se,{modelValue:s.status,"onUpdate:modelValue":o[12]||(o[12]=t=>s.status=t),"active-value":"active","inactive-value":"inactive","active-text":e.$t("admin.active"),"inactive-text":e.$t("admin.inactive")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Ee=Ue(ze,[["__scopeId","data-v-d30af0a3"]]);export{Ee as default};
