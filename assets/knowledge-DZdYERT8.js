import{ao as H,r as i,s as v,ap as n}from"./index-CMTRBr-a.js";const j=H("knowledge",()=>{const l=i([]),u=i(null),p=i([]),d=i([]),h=i([]),y=i([]),g=i({page:1,pageSize:10,total:0,totalPages:0}),a=i(!1),f=i({}),A=v(()=>l.value.length),m=v(()=>l.value.filter(e=>e.status==="published")),F=v(()=>l.value.filter(e=>e.status==="draft"));async function w(e=1,t=10,r,o){a.value=!0;try{const s=await n.getPublishedArticles({page:e,pageSize:t,keyword:r,category:o});if(s.code===200&&s.data){const c=s.data;l.value=c.items,g.value={page:c.page,pageSize:c.pageSize,total:c.total,totalPages:c.totalPages}}}catch(s){console.error("Fetch articles error:",s)}finally{a.value=!1}}async function S(e=1,t=10,r){a.value=!0;try{const o={...f.value,...r},s=await n.getArticles({page:e,pageSize:t,filter:o});if(s.code===200&&s.data){const c=s.data;l.value=c.items,g.value={page:c.page,pageSize:c.pageSize,total:c.total,totalPages:c.totalPages}}}catch(o){console.error("Fetch all articles error:",o)}finally{a.value=!1}}async function b(){a.value=!0;try{const e=await n.getFAQArticles();e.code===200&&e.data&&(p.value=e.data)}catch(e){console.error("Fetch FAQ articles error:",e)}finally{a.value=!1}}async function P(e){if(!e||e.length<2){d.value=[];return}try{const t=await n.getSuggestedArticles(e);t.code===200&&t.data&&(d.value=t.data)}catch(t){console.error("Fetch suggested articles error:",t)}}async function x(e){a.value=!0;try{const t=await n.getArticleById(e);return t.code===200&&t.data?(u.value=t.data,t.data):null}catch(t){return console.error("Fetch article error:",t),null}finally{a.value=!1}}async function z(e){a.value=!0;try{const t=await n.createArticle(e);return t.code===200&&t.data?{success:!0,article:t.data}:{success:!1,message:t.message}}catch(t){return console.error("Create article error:",t),{success:!1,message:"Failed to create article"}}finally{a.value=!1}}async function C(e,t){a.value=!0;try{const r=await n.updateArticle(e,t);if(r.code===200&&r.data){u.value=r.data;const o=l.value.findIndex(s=>s.id===e);return o!==-1&&(l.value[o]=r.data),{success:!0}}return{success:!1,message:r.message}}catch(r){return console.error("Update article error:",r),{success:!1,message:"Failed to update article"}}finally{a.value=!1}}async function I(e){a.value=!0;try{const t=await n.publishArticle(e);if(t.code===200&&t.data){u.value=t.data;const r=l.value.findIndex(o=>o.id===e);return r!==-1&&(l.value[r]=t.data),{success:!0}}return{success:!1,message:t.message}}catch(t){return console.error("Publish article error:",t),{success:!1,message:"Failed to publish article"}}finally{a.value=!1}}async function B(){try{const e=await n.getKBCategories();e.code===200&&e.data&&(h.value=e.data)}catch(e){console.error("Fetch categories error:",e)}}async function Q(){try{const e=await n.getTags();e.code===200&&e.data&&(y.value=e.data)}catch(e){console.error("Fetch tags error:",e)}}function k(e){f.value=e}function K(){f.value={}}function T(){d.value=[]}return{articles:l,currentArticle:u,faqArticles:p,suggestedArticles:d,categories:h,tags:y,pagination:g,loading:a,filter:f,articleCount:A,publishedArticles:m,draftArticles:F,fetchPublicArticles:w,fetchAllArticles:S,fetchFAQArticles:b,fetchSuggestedArticles:P,fetchArticleById:x,createArticle:z,updateArticle:C,publishArticle:I,fetchCategories:B,fetchTags:Q,setFilter:k,clearFilter:K,clearSuggestions:T}});export{j as u};
