import{d as X,k as Y,l as Z,n as V,r as D,o as ee,c as m,e,f as n,w as l,g as c,p as se,$ as te,q as v,y as w,G as I,Q as P,b as ae,h as o,s as z,t as i,S as _,i as C,a9 as S}from"./index-C6r5wVjW.js";import{u as ne}from"./ticket-C_FNrsyi.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"ticket-list-view"},ie={class:"page-header"},de={class:"ticket-cards-container"},re={class:"ticket-collapse-header"},ue={class:"ticket-title-text"},ce={class:"ticket-detail-content"},pe={class:"ticket-info-section"},me={class:"info-left"},_e={class:"info-row"},ve={class:"info-value"},ge={class:"info-value"},fe={class:"info-row"},xe={class:"info-value"},he={class:"info-label",style:{"margin-left":"40px"}},be={class:"info-value"},ye={class:"info-row"},we={class:"info-row"},Ce={class:"description-text"},Se={key:0,class:"attachments-section"},Te={class:"info-label"},Ve={class:"attachment-list"},De={class:"info-right"},ze={class:"status-timeline"},Le={class:"timeline-dot"},Re={class:"timeline-dot"},Ue={key:0,class:"step-number"},$e={class:"timeline-dot"},ke={key:0,class:"step-number"},Ie={class:"timeline-dot"},Pe={key:0,class:"step-number"},Be={class:"pagination-wrapper"},Ne=X({__name:"TicketListView",setup(Ae){const B=ae(),{t:g}=Y(),h=ne(),N=Z(),A=V(()=>h.loading),L=V(()=>h.tickets),f=D(1),b=D(10),R=D([]),O=V(()=>h.pagination.total),U=["new","assigned","in_progress","pending_user","resolved","closed"];function d(a,t){const p=U.indexOf(a.status),x=U.indexOf(t);return p>=x}function q(a){if(a.slaBreached)return g("tickets.slaBreached");if(a.slaResolutionDeadline){const t=new Date(a.slaResolutionDeadline),p=new Date;if((t.getTime()-p.getTime())/(1e3*60*60)<2)return g("tickets.slaAtRisk")}return g("tickets.slaOnTrack")}function M(a){if(a.slaBreached)return"sla-breached";if(a.slaResolutionDeadline){const t=new Date(a.slaResolutionDeadline),p=new Date;if((t.getTime()-p.getTime())/(1e3*60*60)<2)return"sla-at-risk"}return"sla-on-track"}function E(a){B.push(`/tickets/${a.id}`)}function H(a){console.log("Priority changed:",a.id,a.priority)}function j(a){console.log("Status changed:",a.id,a.status)}ee(async()=>{N.setBreadcrumbs([{label:g("nav.dashboard"),path:"/"},{label:g("nav.allTickets")}]),await T()});async function T(){await h.fetchTickets(f.value,b.value,{})}async function F(a){b.value=a,f.value=1,await T()}async function G(a){f.value=a,await T()}return(a,t)=>{const p=c("el-breadcrumb-item"),x=c("el-breadcrumb"),r=c("el-option"),$=c("el-select"),k=c("el-button"),y=c("el-icon"),Q=c("el-collapse-item"),J=c("el-collapse"),K=c("el-pagination"),W=te("loading");return o(),m("div",oe,[e("div",ie,[n(x,{separator:"/"},{default:l(()=>[n(p,{to:{path:"/"}},{default:l(()=>[...t[3]||(t[3]=[w("Home",-1)])]),_:1}),n(p,null,{default:l(()=>[...t[4]||(t[4]=[w("Ticket Management",-1)])]),_:1})]),_:1})]),t[15]||(t[15]=e("div",{class:"page-title-row"},[e("h1",null,"Ticket List")],-1)),e("div",de,[se((o(),v(J,{modelValue:R.value,"onUpdate:modelValue":t[0]||(t[0]=s=>R.value=s),accordion:""},{default:l(()=>[(o(!0),m(I,null,P(L.value,s=>(o(),v(Q,{key:s.id,name:s.id,class:"ticket-collapse-item"},{title:l(()=>[e("div",re,[e("span",ue,i(s.title||`Ticket${L.value.indexOf(s)+1}`),1)])]),default:l(()=>[e("div",ce,[e("div",pe,[e("div",me,[e("div",_e,[t[5]||(t[5]=e("span",{class:"info-label"},"Ticket ID:",-1)),e("span",ve,i(s.id),1),t[6]||(t[6]=e("span",{class:"info-label",style:{"margin-left":"40px"}},"Category:",-1)),e("span",ge,i(s.category?.name||"N/A"),1),e("span",{class:_(["sla-tag",M(s)])}," SLA: "+i(q(s)),3)]),e("div",fe,[t[7]||(t[7]=e("span",{class:"info-label"},"Requester:",-1)),e("span",xe,i(s.requesterName||"xxx"),1),e("span",he,i(a.$t("tickets.contactInfo"))+":",1),e("span",be,i(s.requesterEmail||"xxxxxx"),1)]),e("div",ye,[t[8]||(t[8]=e("span",{class:"info-label"},"Priority:",-1)),n($,{modelValue:s.priority,"onUpdate:modelValue":u=>s.priority=u,size:"small",style:{width:"100px"},onChange:u=>H(s)},{default:l(()=>[n(r,{label:"Low",value:"low"}),n(r,{label:"Medium",value:"medium"}),n(r,{label:"High",value:"high"}),n(r,{label:"Urgent",value:"urgent"})]),_:1},8,["modelValue","onUpdate:modelValue","onChange"])]),e("div",we,[t[9]||(t[9]=e("span",{class:"info-label"},"Status:",-1)),n($,{modelValue:s.status,"onUpdate:modelValue":u=>s.status=u,size:"small",style:{width:"120px"},onChange:u=>j(s)},{default:l(()=>[n(r,{label:"New",value:"new"}),n(r,{label:"Assigned",value:"assigned"}),n(r,{label:"In Progress",value:"in_progress"}),n(r,{label:"Pending User",value:"pending_user"}),n(r,{label:"Resolved",value:"resolved"}),n(r,{label:"Closed",value:"closed"})]),_:1},8,["modelValue","onUpdate:modelValue","onChange"])]),t[10]||(t[10]=e("div",{class:"info-row"},[e("span",{class:"info-label"},"Description:")],-1)),e("div",Ce,i(s.description||"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),1),s.attachments&&s.attachments.length>0?(o(),m("div",Se,[e("span",Te,i(a.$t("tickets.attachments"))+":",1),e("div",Ve,[(o(!0),m(I,null,P(s.attachments,u=>(o(),m("div",{key:u.id,class:"attachment-item"},[e("span",null,"- "+i(u.filename),1),n(k,{type:"primary",size:"small",text:""},{default:l(()=>[w(i(a.$t("tickets.download")),1)]),_:1})]))),128))])])):z("",!0)]),e("div",De,[e("div",ze,[e("div",{class:_(["timeline-item",{active:d(s,"assigned"),current:s.status==="assigned"}])},[e("div",Le,[d(s,"assigned")?(o(),v(y,{key:0},{default:l(()=>[n(C(S))]),_:1})):z("",!0)]),t[11]||(t[11]=e("span",{class:"timeline-label"},"Assigned",-1))],2),e("div",{class:_(["timeline-line",{active:d(s,"in_progress")}])},null,2),e("div",{class:_(["timeline-item",{active:d(s,"in_progress"),current:s.status==="in_progress"}])},[e("div",Re,[s.status==="in_progress"?(o(),m("span",Ue,"2")):d(s,"in_progress")?(o(),v(y,{key:1},{default:l(()=>[n(C(S))]),_:1})):z("",!0)]),t[12]||(t[12]=e("span",{class:"timeline-label"},"In Progress",-1))],2),e("div",{class:_(["timeline-line",{active:d(s,"resolved")}])},null,2),e("div",{class:_(["timeline-item",{active:d(s,"resolved"),current:s.status==="resolved"}])},[e("div",$e,[d(s,"resolved")?(o(),v(y,{key:1},{default:l(()=>[n(C(S))]),_:1})):(o(),m("span",ke,"3"))]),t[13]||(t[13]=e("span",{class:"timeline-label"},"Resolved",-1))],2),e("div",{class:_(["timeline-line",{active:d(s,"closed")}])},null,2),e("div",{class:_(["timeline-item",{active:d(s,"closed"),current:s.status==="closed"}])},[e("div",Ie,[d(s,"closed")?(o(),v(y,{key:1},{default:l(()=>[n(C(S))]),_:1})):(o(),m("span",Pe,"4"))]),t[14]||(t[14]=e("span",{class:"timeline-label"},"Closed",-1))],2)]),n(k,{type:"primary",text:"",class:"see-more-btn",onClick:u=>E(s)},{default:l(()=>[w(i(a.$t("tickets.seeMoreDetails")),1)]),_:1},8,["onClick"])])])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])),[[W,A.value]])]),e("div",Be,[n(K,{"current-page":f.value,"onUpdate:currentPage":t[1]||(t[1]=s=>f.value=s),"page-size":b.value,"onUpdate:pageSize":t[2]||(t[2]=s=>b.value=s),total:O.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:F,onCurrentChange:G},null,8,["current-page","page-size","total"])])])}}}),Ee=le(Ne,[["__scopeId","data-v-185087b7"]]);export{Ee as default};
